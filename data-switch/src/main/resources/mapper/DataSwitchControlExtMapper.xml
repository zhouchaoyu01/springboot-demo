<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dataSwitch.base.dao.DataSwitchControlExtMapper">
    <resultMap id="BaseResultMap" type="com.dataSwitch.base.bean.DataSwitchControlExt">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="row_id" jdbcType="BIGINT" property="rowId" />
        <result column="src_ds_id" jdbcType="BIGINT" property="srcDsId" />
        <result column="start_time" jdbcType="VARCHAR" property="startTime" />
        <result column="catch_step" jdbcType="INTEGER" property="catchStep" />
        <result column="forward_step" jdbcType="INTEGER" property="forwardStep" />
        <result column="wait_trans_time" jdbcType="INTEGER" property="waitTransTime" />
        <result column="retrys" jdbcType="INTEGER" property="retrys" />
<!--        <result column="COMPARE_COLUMN" jdbcType="VARCHAR" property="compareColumn" />-->
<!--        <result column="RULE_ID" jdbcType="DECIMAL" property="ruleId" />-->
        <result column="status" jdbcType="CHAR" property="status" />
        <result column="batch_flag" jdbcType="CHAR" property="batchFlag" />
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
        <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
<!--        <result column="LAST_MODIFY_TIME" jdbcType="TIMESTAMP" property="lastModifyTime" />-->
        <result column="priority_level" jdbcType="VARCHAR" property="priorityLevel" />
<!--        <result column="processing_type" jdbcType="VARCHAR" property="processingType" />-->
    </resultMap>


    <select id="selectAllByPriority" resultMap="BaseResultMap">
        select a.*,b.priority_level from data_switch_control a left join data_switch_sub_control b on a.row_id = b.main_id where a.status='0'  and b.status='0' group by b.main_id,b.priority_level
    </select>

<!--    <select id="selectAllByPriorityAndId" resultMap="BaseResultMap" parameterType="Long">-->
<!--        select a.*,b.PRIORITY_LEVEL from DATA_SWITCH_CONTROL a left join DATA_SWITCH_SUB_CONTROL b on a.row_id = b.MAIN_ID where a.row_id = #{id} and b.SOURCE_TYPE='0' group by b.MAIN_ID,b.PRIORITY_LEVEL-->
<!--    </select>-->

<!--    <update id="updateMainControlBySub">-->
<!--        update DATA_SWITCH_CONTROL a set START_TIME = (select min(START_TIME) from DATA_SWITCH_SUB_CONTROL where main_id=a.row_id and STATUS='0')  where a.STATUS='0'-->
<!--    </update>-->


</mapper>